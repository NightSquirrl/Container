<svg viewBox="0 0 1400 1050" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="blueGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4FC3F7;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#29B6F6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="cyanGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4DD0E1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#26C6DA;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="purpleGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9575CD;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7E57C2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="orangeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#F57C00;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="greenGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#66BB6A;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4CAF50;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- 外层边框 -->
  <rect x="50" y="50" width="1300" height="950" rx="5" fill="#E8F5E9" stroke="#4CAF50" stroke-width="3"/>

  <!-- 视图渲染层 -->
  <g>
    <!-- 标签 -->
    <path d="M 90 90 L 90 180 L 210 180 L 230 160 L 230 90 Z" fill="url(#blueGrad)" stroke="#1976D2" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="130" font-size="18" font-weight="bold" text-anchor="middle" fill="white">视图</text>
    <text x="160" y="155" font-size="18" font-weight="bold" text-anchor="middle" fill="white">渲染层</text>

    <!-- 视图渲染层容器 -->
    <rect x="250" y="90" width="1050" height="120" rx="8" fill="none" stroke="#29B6F6" stroke-width="2" stroke-dasharray="8,4"/>

    <!-- 用户输入 -->
    <rect x="280" y="110" width="180" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="370" y="145" font-size="15" font-weight="bold" text-anchor="middle" fill="white">用户输入</text>
    <text x="370" y="170" font-size="11" text-anchor="middle" fill="white">DSL Script 脚本</text>

    <!-- ImageView -->
    <rect x="490" y="110" width="150" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="565" y="140" font-size="14" font-weight="bold" text-anchor="middle" fill="white">ImageView</text>
    <text x="565" y="162" font-size="11" text-anchor="middle" fill="white">.vue</text>
    <text x="565" y="180" font-size="10" text-anchor="middle" fill="#E8F5E9">图片视图组件</text>

    <!-- TextView -->
    <rect x="670" y="110" width="150" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="745" y="140" font-size="14" font-weight="bold" text-anchor="middle" fill="white">TextView</text>
    <text x="745" y="162" font-size="11" text-anchor="middle" fill="white">.vue</text>
    <text x="745" y="180" font-size="10" text-anchor="middle" fill="#E8F5E9">文本视图组件</text>

    <!-- OtherView -->
    <rect x="850" y="110" width="150" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="925" y="140" font-size="14" font-weight="bold" text-anchor="middle" fill="white">其他View</text>
    <text x="925" y="162" font-size="11" text-anchor="middle" fill="white">.vue</text>
    <text x="925" y="180" font-size="10" text-anchor="middle" fill="#E8F5E9">更多视图组件</text>

    <!-- 动画渲染 -->
    <rect x="1030" y="110" width="180" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="1120" y="145" font-size="15" font-weight="bold" text-anchor="middle" fill="white">动画渲染</text>
    <text x="1120" y="170" font-size="11" text-anchor="middle" fill="white">Animation Render</text>
  </g>

  <!-- 脚本解析层 -->
  <g>
    <!-- 标签 -->
    <path d="M 90 230 L 90 320 L 210 320 L 230 300 L 230 230 Z" fill="url(#cyanGrad)" stroke="#0097A7" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="265" font-size="18" font-weight="bold" text-anchor="middle" fill="white">脚本</text>
    <text x="160" y="290" font-size="18" font-weight="bold" text-anchor="middle" fill="white">解析层</text>

    <!-- 解析层容器 -->
    <rect x="250" y="230" width="1050" height="120" rx="8" fill="none" stroke="#26C6DA" stroke-width="2" stroke-dasharray="8,4"/>

    <!-- DOMParser -->
    <rect x="280" y="250" width="230" height="80" rx="6" fill="#FFD54F" filter="url(#shadow)"/>
    <text x="395" y="275" font-size="15" font-weight="bold" text-anchor="middle" fill="#333">DOMParser</text>
    <text x="395" y="297" font-size="11" text-anchor="middle" fill="#555">脚本解析器</text>
    <text x="395" y="315" font-size="10" text-anchor="middle" fill="#777">Script → DOM Class</text>

    <!-- useDslNode -->
    <rect x="540" y="250" width="230" height="80" rx="6" fill="#FFD54F" filter="url(#shadow)"/>
    <text x="655" y="275" font-size="15" font-weight="bold" text-anchor="middle" fill="#333">useDslNode</text>
    <text x="655" y="297" font-size="11" text-anchor="middle" fill="#555">DSL构建方法</text>
    <text x="655" y="315" font-size="10" text-anchor="middle" fill="#777">DOM → DSL Node</text>

    <!-- 表达式解析器 -->
    <rect x="800" y="250" width="230" height="80" rx="6" fill="#FFD54F" filter="url(#shadow)"/>
    <text x="915" y="275" font-size="15" font-weight="bold" text-anchor="middle" fill="#333">表达式解析器</text>
    <text x="915" y="297" font-size="11" text-anchor="middle" fill="#555">Expression Parser</text>
    <text x="915" y="315" font-size="10" text-anchor="middle" fill="#777">计算字符串表达式</text>

    <!-- Node类型 -->
    <rect x="1060" y="250" width="180" height="80" rx="6" fill="#FFD54F" filter="url(#shadow)"/>
    <text x="1150" y="270" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">Node类型</text>
    <text x="1150" y="290" font-size="10" text-anchor="middle" fill="#555">动画Node</text>
    <text x="1150" y="306" font-size="10" text-anchor="middle" fill="#555">命令Node</text>
    <text x="1150" y="322" font-size="10" text-anchor="middle" fill="#555">视图Node</text>
  </g>

  <!-- 数据管理层 -->
  <g>
    <!-- 标签 -->
    <path d="M 90 370 L 90 720 L 210 720 L 230 700 L 230 370 Z" fill="url(#purpleGrad)" stroke="#5E35B1" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="535" font-size="18" font-weight="bold" text-anchor="middle" fill="white">数据</text>
    <text x="160" y="560" font-size="18" font-weight="bold" text-anchor="middle" fill="white">管理层</text>

    <!-- 管理层容器 -->
    <rect x="250" y="370" width="1050" height="350" rx="8" fill="none" stroke="#7E57C2" stroke-width="2" stroke-dasharray="8,4"/>

    <!-- 左侧：核心管理器 -->
    <rect x="270" y="390" width="480" height="310" rx="6" fill="#FFF9C4" stroke="#9575CD" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="510" y="415" font-size="14" font-weight="bold" text-anchor="middle" fill="#5E35B1">核心管理器</text>

    <!-- Context.ts -->
    <rect x="290" y="430" width="200" height="110" rx="5" fill="#81C784" filter="url(#shadow)"/>
    <text x="390" y="460" font-size="15" font-weight="bold" text-anchor="middle" fill="white">Context.ts</text>
    <text x="390" y="482" font-size="11" text-anchor="middle" fill="white">上下文管理器</text>
    <text x="390" y="500" font-size="10" text-anchor="middle" fill="#E8F5E9">· 所有视图节点</text>
    <text x="390" y="516" font-size="10" text-anchor="middle" fill="#E8F5E9">· 所有动画节点</text>
    <text x="390" y="532" font-size="10" text-anchor="middle" fill="#E8F5E9">· 动画控制接口</text>

    <!-- 变量管理器 -->
    <rect x="520" y="430" width="200" height="110" rx="5" fill="#81C784" filter="url(#shadow)"/>
    <text x="620" y="460" font-size="15" font-weight="bold" text-anchor="middle" fill="white">变量管理器</text>
    <text x="620" y="482" font-size="11" text-anchor="middle" fill="white">Variable Manager</text>
    <text x="620" y="500" font-size="10" text-anchor="middle" fill="#E8F5E9">· 变量存储</text>
    <text x="620" y="516" font-size="10" text-anchor="middle" fill="#E8F5E9">· 变量读写</text>
    <text x="620" y="532" font-size="10" text-anchor="middle" fill="#E8F5E9">· 变量更新通知</text>

    <!-- 动画控制器 -->
    <rect x="290" y="560" width="200" height="100" rx="5" fill="#81C784" filter="url(#shadow)"/>
    <text x="390" y="590" font-size="15" font-weight="bold" text-anchor="middle" fill="white">动画控制器</text>
    <text x="390" y="612" font-size="11" text-anchor="middle" fill="white">Animation Controller</text>
    <text x="390" y="630" font-size="10" text-anchor="middle" fill="#E8F5E9">播放 / 停止</text>
    <text x="390" y="646" font-size="10" text-anchor="middle" fill="#E8F5E9">暂停 / 恢复</text>

    <!-- Node管理器 -->
    <rect x="520" y="560" width="200" height="100" rx="5" fill="#81C784" filter="url(#shadow)"/>
    <text x="620" y="590" font-size="15" font-weight="bold" text-anchor="middle" fill="white">Node管理器</text>
    <text x="620" y="612" font-size="11" text-anchor="middle" fill="white">Node Manager</text>
    <text x="620" y="630" font-size="10" text-anchor="middle" fill="#E8F5E9">增删改查</text>
    <text x="620" y="646" font-size="10" text-anchor="middle" fill="#E8F5E9">树结构遍历</text>

    <!-- 右侧：Vue3响应式 -->
    <rect x="780" y="390" width="480" height="310" rx="6" fill="#E1F5FE" stroke="#9575CD" stroke-width="2" stroke-dasharray="5,3"/>
    <text x="1020" y="415" font-size="14" font-weight="bold" text-anchor="middle" fill="#5E35B1">Vue3 响应式系统</text>

    <!-- ref -->
    <rect x="810" y="435" width="180" height="65" rx="5" fill="#4FC3F7" filter="url(#shadow)"/>
    <text x="900" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="white">ref</text>
    <text x="900" y="483" font-size="11" text-anchor="middle" fill="white">基础类型响应式</text>

    <!-- reactive -->
    <rect x="1020" y="435" width="180" height="65" rx="5" fill="#4FC3F7" filter="url(#shadow)"/>
    <text x="1110" y="460" font-size="14" font-weight="bold" text-anchor="middle" fill="white">reactive</text>
    <text x="1110" y="483" font-size="11" text-anchor="middle" fill="white">对象响应式</text>

    <!-- computed -->
    <rect x="810" y="520" width="180" height="65" rx="5" fill="#4FC3F7" filter="url(#shadow)"/>
    <text x="900" y="545" font-size="14" font-weight="bold" text-anchor="middle" fill="white">computed</text>
    <text x="900" y="568" font-size="11" text-anchor="middle" fill="white">计算属性</text>

    <!-- watch -->
    <rect x="1020" y="520" width="180" height="65" rx="5" fill="#4FC3F7" filter="url(#shadow)"/>
    <text x="1110" y="545" font-size="14" font-weight="bold" text-anchor="middle" fill="white">watch</text>
    <text x="1110" y="568" font-size="11" text-anchor="middle" fill="white">侦听器</text>

    <!-- 数据流动说明 -->
    <rect x="810" y="605" width="390" height="55" rx="5" fill="#B3E5FC" filter="url(#shadow)"/>
    <text x="1005" y="625" font-size="13" font-weight="bold" text-anchor="middle" fill="#01579B">数据驱动视图</text>
    <text x="1005" y="648" font-size="11" text-anchor="middle" fill="#01579B">数据变化 → 自动触发视图更新</text>
  </g>

  <!-- 数据存储层 -->
  <g>
    <!-- 标签 -->
    <path d="M 90 740 L 90 830 L 210 830 L 230 810 L 230 740 Z" fill="url(#orangeGrad)" stroke="#E65100" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="780" font-size="18" font-weight="bold" text-anchor="middle" fill="white">数据</text>
    <text x="160" y="805" font-size="18" font-weight="bold" text-anchor="middle" fill="white">存储层</text>

    <!-- 数据层容器 -->
    <rect x="250" y="740" width="1050" height="120" rx="8" fill="none" stroke="#F57C00" stroke-width="2" stroke-dasharray="8,4"/>

    <!-- DSL Node数据 -->
    <g transform="translate(290, 760)">
      <ellipse cx="140" cy="40" rx="130" ry="35" fill="white" stroke="#333" stroke-width="2" filter="url(#shadow)"/>
      <ellipse cx="140" cy="40" rx="130" ry="35" fill="none" stroke="#333" stroke-width="1.5" transform="translate(0,-3)"/>
      <ellipse cx="140" cy="40" rx="130" ry="35" fill="none" stroke="#333" stroke-width="1" transform="translate(0,-6)"/>
      <text x="140" y="33" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">DSL Node</text>
      <text x="140" y="50" font-size="9" text-anchor="middle" fill="#666">name · attrs</text>
      <text x="140" y="63" font-size="9" text-anchor="middle" fill="#666">nodeId · children</text>
    </g>

    <!-- 变量数据 -->
    <g transform="translate(580, 760)">
      <ellipse cx="110" cy="40" rx="100" ry="35" fill="white" stroke="#333" stroke-width="2" filter="url(#shadow)"/>
      <ellipse cx="110" cy="40" rx="100" ry="35" fill="none" stroke="#333" stroke-width="1.5" transform="translate(0,-3)"/>
      <ellipse cx="110" cy="40" rx="100" ry="35" fill="none" stroke="#333" stroke-width="1" transform="translate(0,-6)"/>
      <text x="110" y="38" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">变量数据</text>
      <text x="110" y="54" font-size="9" text-anchor="middle" fill="#666">Variables</text>
    </g>

    <!-- 表达式结果 -->
    <g transform="translate(830, 760)">
      <ellipse cx="120" cy="40" rx="110" ry="35" fill="white" stroke="#333" stroke-width="2" filter="url(#shadow)"/>
      <ellipse cx="120" cy="40" rx="110" ry="35" fill="none" stroke="#333" stroke-width="1.5" transform="translate(0,-3)"/>
      <ellipse cx="120" cy="40" rx="110" ry="35" fill="none" stroke="#333" stroke-width="1" transform="translate(0,-6)"/>
      <text x="120" y="38" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">表达式结果</text>
      <text x="120" y="54" font-size="9" text-anchor="middle" fill="#666">Expressions</text>
    </g>

    <!-- 状态数据 -->
    <g transform="translate(1090, 760)">
      <ellipse cx="100" cy="40" rx="90" ry="35" fill="white" stroke="#333" stroke-width="2" filter="url(#shadow)"/>
      <ellipse cx="100" cy="40" rx="90" ry="35" fill="none" stroke="#333" stroke-width="1.5" transform="translate(0,-3)"/>
      <ellipse cx="100" cy="40" rx="90" ry="35" fill="none" stroke="#333" stroke-width="1" transform="translate(0,-6)"/>
      <text x="100" y="38" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">状态数据</text>
      <text x="100" y="54" font-size="9" text-anchor="middle" fill="#666">States</text>
    </g>
  </g>

  <!-- 🆕 GSAP动画引擎层 -->
  <g>
    <!-- 标签 -->
    <path d="M 90 880 L 90 970 L 210 970 L 230 950 L 230 880 Z" fill="url(#greenGrad)" stroke="#2E7D32" stroke-width="2" filter="url(#shadow)"/>
    <text x="160" y="920" font-size="18" font-weight="bold" text-anchor="middle" fill="white">动画</text>
    <text x="160" y="945" font-size="18" font-weight="bold" text-anchor="middle" fill="white">引擎层</text>

    <!-- GSAP容器 -->
    <rect x="250" y="880" width="1050" height="120" rx="8" fill="none" stroke="#4CAF50" stroke-width="2" stroke-dasharray="8,4"/>

    <!-- GSAP核心 -->
    <rect x="280" y="900" width="240" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="400" y="930" font-size="16" font-weight="bold" text-anchor="middle" fill="white">GSAP Core</text>
    <text x="400" y="952" font-size="11" text-anchor="middle" fill="white">动画Node数据变化控制</text>
    <text x="400" y="970" font-size="10" text-anchor="middle" fill="#E8F5E9">gsap.to() / gsap.from()</text>

    <!-- Timeline -->
    <rect x="550" y="900" width="200" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="650" y="930" font-size="15" font-weight="bold" text-anchor="middle" fill="white">Timeline</text>
    <text x="650" y="952" font-size="11" text-anchor="middle" fill="white">时间轴管理</text>
    <text x="650" y="970" font-size="10" text-anchor="middle" fill="#E8F5E9">动画序列编排</text>

    <!-- Easing -->
    <rect x="780" y="900" width="200" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="880" y="930" font-size="15" font-weight="bold" text-anchor="middle" fill="white">Easing</text>
    <text x="880" y="952" font-size="11" text-anchor="middle" fill="white">缓动函数</text>
    <text x="880" y="970" font-size="10" text-anchor="middle" fill="#E8F5E9">动画曲线控制</text>

    <!-- Plugins -->
    <rect x="1010" y="900" width="230" height="80" rx="6" fill="#66BB6A" filter="url(#shadow)"/>
    <text x="1125" y="925" font-size="15" font-weight="bold" text-anchor="middle" fill="white">Plugins</text>
    <text x="1125" y="947" font-size="10" text-anchor="middle" fill="white">ScrollTrigger / MotionPath</text>
    <text x="1125" y="963" font-size="10" text-anchor="middle" fill="white">Draggable / MorphSVG</text>
    <text x="1125" y="978" font-size="9" text-anchor="middle" fill="#E8F5E9">扩展动画能力</text>
  </g>

  <!-- 数据流连接线 -->
  <!-- 视图层到解析层 -->
  <path d="M 370 210 L 395 250" stroke="#1976D2" stroke-width="2.5" fill="none" marker-end="url(#arrowBlue)"/>
  <text x="365" y="235" font-size="10" fill="#1976D2" font-weight="bold">输入</text>

  <!-- 解析层到管理层 -->
  <path d="M 395 350 L 390 390" stroke="#0097A7" stroke-width="2.5" fill="none" marker-end="url(#arrowPurple)"/>
  <path d="M 655 350 L 620 390" stroke="#0097A7" stroke-width="2.5" fill="none" marker-end="url(#arrowPurple)"/>
  <path d="M 915 350 L 900 390" stroke="#0097A7" stroke-width="2.5" fill="none" marker-end="url(#arrowPurple)"/>

  <!-- 管理层到存储层 -->
  <path d="M 390 720 L 420 760" stroke="#5E35B1" stroke-width="2.5" fill="none" marker-end="url(#arrowOrange)"/>
  <path d="M 620 720 L 690 760" stroke="#5E35B1" stroke-width="2.5" fill="none" marker-end="url(#arrowOrange)"/>
  <path d="M 900 720 L 950 760" stroke="#5E35B1" stroke-width="2.5" fill="none" marker-end="url(#arrowOrange)"/>

  <!-- 🆕 动画控制器到GSAP -->
  <path d="M 390 660 L 400 900" stroke="#4CAF50" stroke-width="3" fill="none" marker-end="url(#arrowGreen)" stroke-dasharray="6,3"/>
  <text x="350" y="780" font-size="11" fill="#2E7D32" font-weight="bold">动画Node</text>
  <text x="350" y="795" font-size="11" fill="#2E7D32" font-weight="bold">数据控制</text>

  <!-- 🆕 GSAP到视图层 -->
  <path d="M 650 900 L 1120 210" stroke="#4CAF50" stroke-width="3" fill="none" marker-end="url(#arrowGreen)" stroke-dasharray="6,3"/>
  <text x="880" y="550" font-size="11" fill="#2E7D32" font-weight="bold">驱动动画渲染</text>

  <!-- 响应式数据流：存储层到视图层 -->
  <path d="M 560 740 L 560 680 Q 560 640, 600 640 L 850 640 Q 890 640, 890 600 L 890 210" 
    stroke="#FF6B6B" stroke-width="3" fill="none" marker-end="url(#arrowRed)" stroke-dasharray="8,4"/>
  <text x="720" y="632" font-size="12" fill="#FF6B6B" font-weight="bold">响应式数据流</text>
  <text x="720" y="650" font-size="10" fill="#FF6B6B">数据变化自动触发视图更新</text>

  <!-- 箭头标记 -->
  <defs>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#1976D2" />
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#5E35B1" />
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <path d="M0,0 L0,6 L9,3 z" fill="#F57C00" />
    </marker>
    <marker id="arrowRed" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto">
      <path d="M0,0 L0,6 L10,3 z" fill="#FF6B6B" />
    </marker>
    <marker id="arrowGreen" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto">
      <path d="M0,0 L0,6 L10,3 z" fill="#4CAF50" />
    </marker>
  </defs>

  <!-- 底部说明 -->
  <text x="700" y="1030" font-size="13" text-anchor="middle" fill="#5E35B1" font-weight="bold">
    DSL脚本解析渲染系统 - Vue3响应式 + GSAP动画引擎驱动的动态视图渲染架构
  </text>
</svg>
